var ie=Object.defineProperty,se=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var q=(i,a,l)=>a in i?ie(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,B=(i,a)=>{for(var l in a||(a={}))de.call(a,l)&&q(i,l,a[l]);if(J)for(var l of J(a))me.call(a,l)&&q(i,l,a[l]);return i},Q=(i,a)=>se(i,ne(a));var c=(i,a,l)=>new Promise((D,x)=>{var V=d=>{try{g(l.next(d))}catch(m){x(m)}},A=d=>{try{g(l.throw(d))}catch(m){x(m)}},g=d=>d.done?D(d.value):Promise.resolve(d.value).then(V,A);g((l=l.apply(i,a)).next())});import{_ as W}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bkv9eS5E.js";import{c as ue,i as p}from"./index-TwgnzE1J.js";import{_ as ce}from"./Table.vue_vue_type_script_lang-DF00gmO3.js";/* empty css                *//* empty css                    *//* empty css                   */import{g as X,b as pe,c as fe,e as ve}from"./index-B5_fTx-q.js";import{u as he}from"./useTable-eC-wqEjB.js";import{_ as ge}from"./Search.vue_vue_type_script_setup_true_lang-Cz6vOz8b.js";import{_ as _e}from"./Write.vue_vue_type_script_setup_true_lang-Y_4gm3Sc.js";import{_ as ye}from"./Detail.vue_vue_type_script_setup_true_lang-CNlYm29L.js";import{_ as De}from"./Dialog.vue_vue_type_style_index_0_lang-rGXcOO5g.js";import{g as xe}from"./index-BCiKIuCL.js";import{u as be}from"./useCrudSchemas-gk09B-eB.js";import{z as we,n as ke,L as Se}from"./element-plus-B5Fb1RnA.js";import{v as Ce,V as Ne,M as s,H as Ve,r as n,w as Ae,u as e,x as S,y as Te,K as u,B as C,P as h,a3 as N,k as Y,J as E,G as I,a7 as Re,n as Le}from"./vue-chunks-mpUGqK7y.js";/* empty css                *//* empty css                  *//* empty css                        *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-radio-button-AjL4fsfV.js";/* empty css                         *//* empty css                  */import"./index-BWEdXBfz.js";import"./Form-CvK45EYM.js";/* empty css                     *//* empty css               *//* empty css                 *//* empty css                        *//* empty css                    */import"./InputPassword-pgTKlS02.js";import"./style.css_vue_type_style_index_0_src_true_lang-BRXh3nzb.js";import"./wang-editor-1CUj_mB-.js";import"./JsonEditor.vue_vue_type_script_setup_true_lang-mrNLuSy8.js";import"./IconPicker-DMkJAgXY.js";import"./IAgree.vue_vue_type_script_setup_true_lang-DARadFGj.js";import"./Highlight.vue_vue_type_script_lang-zSVHTRSq.js";import"./useForm-CPG8etzq.js";import"./useIcon-B1ne9PpA.js";import"./useValidator-BjWQ_jvF.js";import"./Descriptions-CLg8ncox.js";import"./tree-Dgaev6Pi.js";const $e={class:"flex w-100% h-100%"},Pe={class:"flex justify-center items-center"},Ue={class:"flex-1"},ze=["title"],Be={class:"mb-10px"};function j(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Re(i)}const Lt=Ce({__name:"User",setup(i){const{t:a}=ue(),{tableRegister:l,tableState:D,tableMethods:x}=he({fetchDataApi:()=>c(this,null,function*(){const{pageSize:r,currentPage:t}=D,o=yield pe(B({id:e(_),pageIndex:e(t),pageSize:e(r)},e(K)));return{list:o.data.list||[],total:o.data.total||0}}),fetchDelApi:()=>c(this,null,function*(){return!!(yield fe(e(P)))})}),{total:V,loading:A,dataList:g,pageSize:d,currentPage:m}=D,{getList:T,getElTableExpose:Z,delList:ee}=x,te=Ne([{field:"selection",search:{hidden:!0},form:{hidden:!0},detail:{hidden:!0},table:{type:"selection"}},{field:"index",label:a("userDemo.index"),form:{hidden:!0},search:{hidden:!0},detail:{hidden:!0},table:{type:"index"}},{field:"username",label:a("userDemo.username")},{field:"account",label:a("userDemo.account")},{field:"department.id",label:a("userDemo.department"),detail:{hidden:!0},search:{hidden:!0},form:{component:"TreeSelect",componentProps:{nodeKey:"id",props:{label:"departmentName"}},optionApi:()=>c(this,null,function*(){return(yield X()).data.list})},table:{hidden:!0}},{field:"role",label:a("userDemo.role"),search:{hidden:!0},form:{component:"Select",value:[],componentProps:{multiple:!0,collapseTags:!0,maxCollapseTags:1},optionApi:()=>c(this,null,function*(){var t,o;return(o=(t=(yield xe()).data)==null?void 0:t.list)==null?void 0:o.map(v=>({label:v.roleName,value:v.id}))})}},{field:"email",label:a("userDemo.email"),form:{component:"Input"},search:{hidden:!0}},{field:"createTime",label:a("userDemo.createTime"),form:{component:"Input"},search:{hidden:!0}},{field:"action",label:a("userDemo.action"),form:{hidden:!0},detail:{hidden:!0},search:{hidden:!0},table:{width:240,slots:{default:r=>{let t,o,v;const z=r.row;return s(Ve,null,[s(p,{type:"primary",onClick:()=>G(z,"edit")},j(t=a("exampleDemo.edit"))?t:{default:()=>[t]}),s(p,{type:"success",onClick:()=>G(z,"detail")},j(o=a("exampleDemo.detail"))?o:{default:()=>[o]}),s(p,{type:"danger",onClick:()=>F(z)},j(v=a("exampleDemo.del"))?v:{default:()=>[v]})])}}}}]),{allSchemas:b}=be(te),K=n({}),M=r=>{m.value=1,K.value=r,T()},w=n(),_=n(""),O=n([]);c(this,null,function*(){var t,o;const r=yield X();O.value=r.data.list,_.value=r.data.list[0]&&((t=r.data.list[0])==null?void 0:t.children)&&r.data.list[0].children[0].id||"",yield Le(),(o=e(w))==null||o.setCurrentKey(_.value)});const R=n("");Ae(()=>R.value,r=>{e(w).filter(r)});const ae=r=>{_.value=r.id,m.value=1,T()},oe=(r,t)=>r?t.departmentName.includes(r):!0,f=n(!1),L=n(""),k=n(),y=n(""),re=()=>{L.value=a("exampleDemo.add"),k.value=void 0,f.value=!0,y.value=""},$=n(!1),P=n([]),F=r=>c(this,null,function*(){const t=yield Z();P.value=r?[r.id]:(t==null?void 0:t.getSelectionRows().map(o=>o.id))||[],$.value=!0,yield ee(e(P).length).finally(()=>{$.value=!1})}),G=(r,t)=>{var o;L.value=a(t==="edit"?"exampleDemo.edit":"exampleDemo.detail"),y.value=t,k.value=Q(B({},r),{department:((o=e(w))==null?void 0:o.getCurrentNode())||{}}),f.value=!0},H=n(),U=n(!1),le=()=>c(this,null,function*(){const r=e(H),t=yield r==null?void 0:r.submit();if(t){U.value=!0;try{(yield ve(t))&&(m.value=1,T())}catch(o){}finally{U.value=!1,f.value=!1}}});return(r,t)=>(S(),Te("div",$e,[s(e(W),{class:"w-250px"},{default:u(()=>[C("div",Pe,[C("div",Ue,h(e(a)("userDemo.departmentList")),1),s(e(we),{modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=o=>R.value=o),class:"flex-[2]",placeholder:e(a)("userDemo.searchDepartment"),clearable:""},null,8,["modelValue","placeholder"])]),s(e(ke)),s(e(Se),{ref_key:"treeEl",ref:w,data:O.value,"default-expand-all":"","expand-on-click-node":!1,"node-key":"id","current-node-key":_.value,props:{label:"departmentName"},"filter-node-method":oe,onCurrentChange:ae},{default:u(({data:o})=>[C("div",{title:o.departmentName,class:"whitespace-nowrap overflow-ellipsis overflow-hidden"},h(o.departmentName),9,ze)]),_:1},8,["data","current-node-key"])]),_:1}),s(e(W),{class:"flex-[3] ml-20px"},{default:u(()=>[s(e(ge),{schema:e(b).searchSchema,onReset:M,onSearch:M},null,8,["schema"]),C("div",Be,[s(e(p),{type:"primary",onClick:re},{default:u(()=>[N(h(e(a)("exampleDemo.add")),1)]),_:1}),s(e(p),{loading:$.value,type:"danger",onClick:t[1]||(t[1]=o=>F())},{default:u(()=>[N(h(e(a)("exampleDemo.del")),1)]),_:1},8,["loading"])]),s(e(ce),{"current-page":e(m),"onUpdate:currentPage":t[2]||(t[2]=o=>Y(m)?m.value=o:null),"page-size":e(d),"onUpdate:pageSize":t[3]||(t[3]=o=>Y(d)?d.value=o:null),columns:e(b).tableColumns,data:e(g),loading:e(A),onRegister:e(l),pagination:{total:e(V)}},null,8,["current-page","page-size","columns","data","loading","onRegister","pagination"])]),_:1}),s(e(De),{modelValue:f.value,"onUpdate:modelValue":t[5]||(t[5]=o=>f.value=o),title:L.value},{footer:u(()=>[y.value!=="detail"?(S(),E(e(p),{key:0,type:"primary",loading:U.value,onClick:le},{default:u(()=>[N(h(e(a)("exampleDemo.save")),1)]),_:1},8,["loading"])):I("",!0),s(e(p),{onClick:t[4]||(t[4]=o=>f.value=!1)},{default:u(()=>[N(h(e(a)("dialogDemo.close")),1)]),_:1})]),default:u(()=>[y.value!=="detail"?(S(),E(_e,{key:0,ref_key:"writeRef",ref:H,"form-schema":e(b).formSchema,"current-row":k.value},null,8,["form-schema","current-row"])):I("",!0),y.value==="detail"?(S(),E(ye,{key:1,"detail-schema":e(b).detailSchema,"current-row":k.value},null,8,["detail-schema","current-row"])):I("",!0)]),_:1},8,["modelValue","title"])]))}});export{Lt as default};
